

# 实验室发票管理系统需求规格说明书



[TOC]

## 1.  基本信息

### 1.1 目标

- 方便学生进行发票提交；
- 方便管理员审批发票；
- 方便管理员统计和导出发票信息。

### 1.2 涉众分析

涉及到的群体有：

| 涉众          | 期望功能                                                     |
| :------------ | ------------------------------------------------------------ |
| 学生          | 1. 能简易直接地提交发票；2. 能清晰的查看所有发票状态。       |
| 管理员        | 1. 能方便地进行发票审批、修改；2. 可以一键导出选中分组的发票数据。 |
| 教师/管理人员 | 1. 能获得清晰明了的发票导出数据。                            |

## 2. 业务分析

### 2.1 业务概念

![ ](/Users/mensssy/Documents/Programme/Go/LabMS/doc/diagram/LabMSClasses.png) 

 其中，学生在填写发票时需包含的详细信息有： 

| <span style="display:inline-block;width:80px">信息类型</span> |                             备注                             |
| :----------------------------------------------------------: | :----------------------------------------------------------: |
|                            姓名*                             |                                                              |
|                          发票类型*                           | 非手动填写，发票类型为预定的选项，包括1.材料；2.打车；3.印刷品；4.专利软著出版；5.会议论文发表；6.物流快递；7.委托服务；8.办公文具；9.食品；10.教学科研交流；11.其他特殊。 |
|                          物品名称*                           |                                                              |
|                            金额*                             |                                                              |
|                            用途*                             |                                                              |
|                           文件凭证                           | 发票超过200元需提供付款记录截图，超过5000元需再提供发票查验结果。材料费发票超过1000元须上传材料平台登记文件。 |

> [!NOTE]
>
> 信息类型后有*，代表该信息必需填写。

### 2.2 业务流程分析

在本项目的业务中，除去发票提交和审核需要学生以及管理员共同参与外，其他功能中两位角色无交集。

#### 2.2.1 发票提交及其审核

该功能是本项目最主要的和最基本的功能。

![](/Users/mensssy/Documents/Programme/Go/LabMS/doc/diagram/LabMSInvoiceSubmit_Process.png)

> [!NOTE]
>
> 该流程图针对的是单张发票在报销流程中的情况，实际情况下，可以同时选择多张发票，并行执行此流程或其中的某一段流程。报销成功的发票会按批次进行记录。

发票有如下状态：

1. 等待审核；
2. 审核通过；
3. 审核驳回，驳回后学生可选择修改然后再次提交（转状态1）或放弃修改（转状态6）；
4. 已送报；
5. 报销成功；
6. 报销失败。

> [!NOTE]
>
> 对于状态已送报，报销成功和报销失败的更新，需要管理员进行手动更新。

#### 2.2.2 统计数据导出

为方便发票数据的整理，可以按以下三种分组方式将发票进行导出，导出格式为excel，默认顺序为时间顺序，同时完成统计数据可视化。

1. 先按报销批次分组，在同一批次内再按照发票类型或报销人姓名分组；
2. 限定时间段内的发票组；
3. 自定义勾选发票组。

按批次分组，批次内按类型分组的例子：

**印刷品类型发票明细**

| 序号 | 提交人 | 发票类型 | 报销金额 | 报销结果 | ...  |
| ---- | ------ | -------- | -------- | -------- | ---- |
| 1    | 张三   | 印刷品   | 1.10     | 成功     | ...  |
| 2    | 李四   | 印刷品   | 12.00    | 失败     | ...  |

**材料类型发票明细**

| 序号 | 提交人 | 发票类型 | 报销金额 | 报销结果 | ...  |
| ---- | ------ | -------- | -------- | -------- | ---- |
| 1    | 张三   | 材料     | 789.50   | 成功     | ...  |
| 2    | 李四   | 材料     | 45.00    | 失败     | ...  |

## 3. 功能性需求

### 3.1 学生用户用例

![](/Users/mensssy/Documents/Programme/Go/LabMS/doc/diagram/LabMS_StuUseCases.png)

### 3.2 管理者用例

![](/Users/mensssy/Documents/Programme/Go/LabMS/doc/diagram/LabMS_AdmiUseCase.png)

## 4. 非功能性需求

### 4.1 数据库安全

数据库中的用户隐私信息将通过加盐哈希进行加密，每个用户的盐值不同，在注册时随机生成。

### 4.2 网络安全

网络安全主要与token有关，相关规则设定如下：

1. 每个用户在登录成功后会刷新并获取到新的token；
2. token有效期默认为2小时；
3. 一个用户可手机端与电脑端同时在线，但不可同时登录同一端的设备，若同时登录，先登录设备的token会过期失效。

token鉴权相关流程图如下：

![image-20241122200316193](/Users/mensssy/Library/Application Support/typora-user-images/image-20241122200316193.png)